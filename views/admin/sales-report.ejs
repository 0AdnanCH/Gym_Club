<!DOCTYPE html>
<html lang="en">


<!-- Mirrored from techzaa.in/larkon/admin/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 03 Dec 2024 05:41:47 GMT -->
<head>
     <!-- Title Meta -->
     <meta charset="utf-8" />
     <title>Sales Report | GYM WEAR </title>
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta name="description" content="A fully responsive premium admin dashboard template" />
     <meta name="author" content="Techzaa" />
     <meta http-equiv="X-UA-Compatible" content="IE=edge" />

     <!-- App favicon -->
     <link rel="shortcut icon" href="assets/images/favicon.ico">

     <!-- Vendor css (Require in all Page) -->
     <link href="assets/css/vendor.min.css" rel="stylesheet" type="text/css" />

     <!-- Icons css (Require in all Page) -->
     <link href="assets/css/icons.min.css" rel="stylesheet" type="text/css" />

     <!-- App css (Require in all Page) -->
     <link href="assets/css/app.min.css" rel="stylesheet" type="text/css" />

     <!-- Theme Config js (Require in all Page) -->
     <script src="assets/js/config.js"></script>
     <style>
     .display-none {
      display: none;
     }
      .filter-header {
          font-size: 18px;
          font-weight: bold;
          margin-bottom: 20px;
          color: #333;
      }

      .filter-section {
          display: flex;
          flex-wrap: wrap;
          gap: 20px;
          align-items: center;
      }

      .date-range {
          display: flex;
          align-items: center;
          gap: 10px;
      }

      .date-input {
          padding: 8px 12px;
          border: 1px solid #ddd;
          border-radius: 4px;
          font-size: 14px;
      }

      .quick-filter {
          padding: 8px 12px;
          border: 1px solid #ddd;
          border-radius: 4px;
          font-size: 14px;
          background-color: white;
          cursor: pointer;
      }

      .quick-filter:hover {
          border-color: #999;
      }

      label {
          font-weight: 500;
          color: #666;
      }

      .apply-btn {
          background-color: #0066cc;
          color: white;
          padding: 8px 16px;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-size: 14px;
      }

      .apply-btn:hover {
          background-color: #0052a3;
      }
  </style>
</head>

<body>

     <!-- START Wrapper -->
     <div class="wrapper">

          <!-- ========== Topbar Start ========== -->
          <header class="topbar">
               <div class="container-fluid">
                    <div class="navbar-header">
                         <div class="d-flex align-items-center">
                              <!-- Menu Toggle Button -->
                              <div class="topbar-item">
                                   <button type="button" class="button-toggle-menu me-2">
                                        <iconify-icon icon="solar:hamburger-menu-broken" class="fs-24 align-middle"></iconify-icon>
                                   </button>
                              </div>

                              <!-- Menu Toggle Button -->
                              <div class="topbar-item">
                                   <h4 class="fw-bold topbar-button pe-none text-uppercase mb-0">SALES REPORT</h4>
                              </div>
                         </div>

                         <div class="d-flex align-items-center gap-1">

                              <!-- Theme Color (Light/Dark) -->
                              <div class="topbar-item">
                                   <button type="button" class="topbar-button" id="light-dark-mode">
                                        <iconify-icon icon="solar:moon-bold-duotone" class="fs-24 align-middle"></iconify-icon>
                                   </button>
                              </div>

                              <!-- Theme Setting -->
                              <div class="topbar-item d-none d-md-flex">
                                   <button type="button" class="topbar-button" id="theme-settings-btn" data-bs-toggle="offcanvas" data-bs-target="#theme-settings-offcanvas" aria-controls="theme-settings-offcanvas">
                                        <iconify-icon icon="solar:settings-bold-duotone" class="fs-24 align-middle"></iconify-icon>
                                   </button>
                              </div>


                              <!-- User -->
                              <div class="dropdown topbar-item">
                                   <a type="button" class="topbar-button" id="page-header-user-dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <span class="d-flex align-items-center">
                                             <img class="rounded-circle" width="32" src="assets/images/users/avatar-1.jpg" alt="avatar-3">
                                        </span>
                                   </a>
                                   <div class="dropdown-menu dropdown-menu-end">
                                        <!-- item-->
                                        <h6 class="dropdown-header">Welcome Gaston!</h6>
                                        <a class="dropdown-item" href="#">
                                             <i class="bx bx-user-circle text-muted fs-18 align-middle me-1"></i><span class="align-middle">Profile</span>
                                        </a>

                                        <div class="dropdown-divider my-1"></div>

                                        <button class="dropdown-item text-danger" id="logout-btn">
                                             <i class="bx bx-log-out fs-18 align-middle me-1"></i><span class="align-middle">Logout</span>
                                        </button>
                                   </div>
                              </div>
                         </div>
                    </div>
               </div>
          </header>

          <!-- Right Sidebar (Theme Settings) -->
          <div>
               <div class="offcanvas offcanvas-end border-0" tabindex="-1" id="theme-settings-offcanvas">
                    <div class="d-flex align-items-center bg-primary p-3 offcanvas-header">
                         <h5 class="text-white m-0">Theme Settings</h5>
                         <button type="button" class="btn-close btn-close-white ms-auto" data-bs-dismiss="offcanvas" aria-label="Close"></button>
                    </div>

                    <div class="offcanvas-body p-0">
                         <div data-simplebar class="h-100">
                              <div class="p-3 settings-bar">

                                   <div>
                                        <h5 class="mb-3 font-16 fw-semibold">Color Scheme</h5>

                                        <div class="form-check mb-2">
                                             <input class="form-check-input" type="radio" name="data-bs-theme" id="layout-color-light" value="light">
                                             <label class="form-check-label" for="layout-color-light">Light</label>
                                        </div>

                                        <div class="form-check mb-2">
                                             <input class="form-check-input" type="radio" name="data-bs-theme" id="layout-color-dark" value="dark">
                                             <label class="form-check-label" for="layout-color-dark">Dark</label>
                                        </div>
                                   </div>

                                   <div>
                                        <h5 class="my-3 font-16 fw-semibold">Topbar Color</h5>

                                        <div class="form-check mb-2">
                                             <input class="form-check-input" type="radio" name="data-topbar-color" id="topbar-color-light" value="light">
                                             <label class="form-check-label" for="topbar-color-light">Light</label>
                                        </div>
                                        <div class="form-check mb-2">
                                             <input class="form-check-input" type="radio" name="data-topbar-color" id="topbar-color-dark" value="dark">
                                             <label class="form-check-label" for="topbar-color-dark">Dark</label>
                                        </div>
                                   </div>


                                   <div>
                                        <h5 class="my-3 font-16 fw-semibold">Menu Color</h5>

                                        <div class="form-check mb-2">
                                             <input class="form-check-input" type="radio" name="data-menu-color" id="leftbar-color-light" value="light">
                                             <label class="form-check-label" for="leftbar-color-light">
                                                  Light
                                             </label>
                                        </div>

                                        <div class="form-check mb-2">
                                             <input class="form-check-input" type="radio" name="data-menu-color" id="leftbar-color-dark" value="dark">
                                             <label class="form-check-label" for="leftbar-color-dark">
                                                  Dark
                                             </label>
                                        </div>
                                   </div>

                                   <div>
                                        <h5 class="my-3 font-16 fw-semibold">Sidebar Size</h5>

                                        <div class="form-check mb-2">
                                             <input class="form-check-input" type="radio" name="data-menu-size" id="leftbar-size-default" value="default">
                                             <label class="form-check-label" for="leftbar-size-default">
                                                  Default
                                             </label>
                                        </div>

                                        <div class="form-check mb-2">
                                             <input class="form-check-input" type="radio" name="data-menu-size" id="leftbar-size-small" value="condensed">
                                             <label class="form-check-label" for="leftbar-size-small">
                                                  Condensed
                                             </label>
                                        </div>

                                        <div class="form-check mb-2">
                                             <input class="form-check-input" type="radio" name="data-menu-size" id="leftbar-hidden" value="hidden">
                                             <label class="form-check-label" for="leftbar-hidden">
                                                  Hidden
                                             </label>
                                        </div>

                                        <div class="form-check mb-2">
                                             <input class="form-check-input" type="radio" name="data-menu-size" id="leftbar-size-small-hover-active" value="sm-hover-active">
                                             <label class="form-check-label" for="leftbar-size-small-hover-active">
                                                  Small Hover Active
                                             </label>
                                        </div>

                                        <div class="form-check mb-2">
                                             <input class="form-check-input" type="radio" name="data-menu-size" id="leftbar-size-small-hover" value="sm-hover">
                                             <label class="form-check-label" for="leftbar-size-small-hover">
                                                  Small Hover
                                             </label>
                                        </div>
                                   </div>

                              </div>
                         </div>
                    </div>
                    <div class="offcanvas-footer border-top p-3 text-center">
                         <div class="row">
                              <div class="col">
                                   <button type="button" class="btn btn-danger w-100" id="reset-layout">Reset</button>
                              </div>
                         </div>
                    </div>
               </div>
          </div>
          <!-- ========== Topbar End ========== -->

          <!-- ========== App Menu Start ========== -->
          <div class="main-nav">
               <!-- Sidebar Logo -->
               <div class="logo-box">
                    <a href="/admin" class="logo-dark">
                         <img src="assets/images/logo-sm.png" class="logo-sm" alt="logo sm">
                         <img src="assets/images/logo-dark.png" class="logo-lg" alt="logo dark">
                    </a>

                    <a href="/admin" class="logo-light">
                         <img src="assets/images/logo-sm.png" class="logo-sm" alt="logo sm">
                         <img src="assets/images/logo-light.png" class="logo-lg" alt="logo light">
                    </a>
               </div>

               <!-- Menu Toggle Button (sm-hover) -->
               <button type="button" class="button-sm-hover" aria-label="Show Full Sidebar">
                    <iconify-icon icon="solar:double-alt-arrow-right-bold-duotone" class="button-sm-hover-icon"></iconify-icon>
               </button>

               <div class="scrollbar" data-simplebar>
                    <ul class="navbar-nav" id="navbar-nav">

                         <li class="menu-title">General</li>

                         <li class="nav-item">
                              <a class="nav-link" href="/admin">
                                   <span class="nav-icon">
                                        <iconify-icon icon="solar:widget-5-bold-duotone"></iconify-icon>
                                   </span>
                                   <span class="nav-text"> Dashboard </span>
                              </a>
                         </li>

                         <li class="nav-item">
                              <a class="nav-link" href="/admin/salesReport">
                                   <span class="nav-icon">
                                        <iconify-icon icon="solar:widget-5-bold-duotone"></iconify-icon>
                                   </span>
                                   <span class="nav-text"> Sales Report </span>
                              </a>
                         </li>

                         <li class="nav-item">
                              <a class="nav-link menu-arrow" href="#sidebarProducts" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="sidebarProducts">
                                   <span class="nav-icon">
                                        <iconify-icon icon="solar:t-shirt-bold-duotone"></iconify-icon>
                                   </span>
                                   <span class="nav-text"> Products </span>
                              </a>
                              <div class="collapse" id="sidebarProducts">
                                   <ul class="nav sub-navbar-nav">
                                        <li class="sub-nav-item">
                                             <a class="sub-nav-link" href="/admin/products">List</a>
                                        </li>
                                        <li class="sub-nav-item">
                                             <a class="sub-nav-link" href="/admin/addProducts">Create</a>
                                        </li>
                                   </ul>
                              </div>
                         </li>

                         <li class="nav-item">
                              <a class="nav-link menu-arrow" href="#sidebarCategory" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="sidebarCategory">
                                   <span class="nav-icon">
                                        <iconify-icon icon="solar:clipboard-list-bold-duotone"></iconify-icon>
                                   </span>
                                   <span class="nav-text"> Category </span>
                              </a>
                              <div class="collapse" id="sidebarCategory">
                                   <ul class="nav sub-navbar-nav">
                                        <li class="sub-nav-item">
                                             <a class="sub-nav-link" href="/admin/category">List</a>
                                        </li>                         
                                        <li class="sub-nav-item">
                                             <a class="sub-nav-link" href="/admin/addCategory">Create</a>
                                        </li>
                                   </ul>
                              </div>
                         </li>
                         <li class="nav-item">
                              <a class="nav-link menu-arrow" href="#sidebarOrders" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="sidebarOrders">
                                   <span class="nav-icon">
                                        <iconify-icon icon="solar:bag-smile-bold-duotone"></iconify-icon>
                                   </span>
                                   <span class="nav-text"> Orders </span>
                              </a>
                              <div class="collapse" id="sidebarOrders">
                                   <ul class="nav sub-navbar-nav">

                                        <li class="sub-nav-item">
                                             <a class="sub-nav-link" href="/admin/order">List</a>
                                        </li>
                                   </ul>
                              </div>
                         </li>

                         <li class="menu-title mt-2">Users</li>

                         <li class="nav-item">
                              <a class="nav-link menu-arrow" href="#sidebarCustomers" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="sidebarCustomers">
                                   <span class="nav-icon">
                                        <iconify-icon icon="solar:users-group-two-rounded-bold-duotone"></iconify-icon>
                                   </span>
                                   <span class="nav-text"> Customers </span>
                              </a>
                              <div class="collapse" id="sidebarCustomers">
                                   <ul class="nav sub-navbar-nav">

                                        <li class="sub-nav-item">
                                             <a class="sub-nav-link" href="/admin/users">List</a>
                                        </li>
                                   </ul>
                              </div>
                         </li>

                         <li class="menu-title mt-2">Other</li>

                         <li class="nav-item">
                              <a class="nav-link menu-arrow" href="#sidebarCoupons" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="sidebarCoupons">
                                   <span class="nav-icon">
                                        <iconify-icon icon="solar:leaf-bold-duotone"></iconify-icon>
                                   </span>
                                   <span class="nav-text"> Coupons </span>
                              </a>
                              <div class="collapse" id="sidebarCoupons">
                                   <ul class="nav sub-navbar-nav">
                                        <li class="sub-nav-item">
                                             <a class="sub-nav-link" href="/admin/coupon">List</a>
                                        </li>
                                        <li class="sub-nav-item">
                                             <a class="sub-nav-link" href="/admin/addCoupon">Add</a>
                                        </li>
                                   </ul>
                              </div>
                         </li>

                         <li class="nav-item">
                              <a class="nav-link menu-arrow" href="#sidebarOffers" data-bs-toggle="collapse" role="button" aria-expanded="false" aria-controls="sidebarOffers">
                                   <span class="nav-icon">
                                        <iconify-icon icon="solar:leaf-bold-duotone"></iconify-icon>
                                   </span>
                                   <span class="nav-text"> Offers </span>
                              </a>
                              <div class="collapse" id="sidebarOffers">
                                   <ul class="nav sub-navbar-nav">
                                        <li class="sub-nav-item">
                                             <a class="sub-nav-link" href="/admin/offers">List</a>
                                        </li>
                                        <li class="sub-nav-item">
                                             <a class="sub-nav-link" href="/admin/addOffer">Add</a>
                                        </li>
                                   </ul>
                              </div>
                         </li>
                    </ul>
               </div>
          </div>
          <!-- ========== App Menu End ========== -->

          <!-- ==================================================== -->
          <!-- Start right Content here -->
          <!-- ==================================================== -->
          <div class="page-content">

               <!-- Start Container Fluid -->
               <div class="container-fluid">
                    <div class="row">
                         <div class="col">
                              <div class="card">
                                <div class="card-body">
                                    <div class="filter-section">
                                        <div class="date-range">
                                            <label>Date Range:</label>
                                            <input type="date" id="startDate" class="date-input">
                                            <span>to</span>
                                            <input type="date" id="endDate" class="date-input">
                                        </div>
                                        <div>
                                            <label>Quick Filter:</label>
                                            <select id="quickFilter" class="quick-filter">
                                                <option value="all">All Time</option>
                                                <option value="today">Today</option>
                                                <option value="week">Last 7 Days</option>
                                                <option value="month">Last 30 Days</option>
                                                <option value="year">Last Year</option>
                                            </select>
                                        </div>
                                        <button class="apply-btn" id="apply-btn">Apply Filters</button>
                                    </div>
                                </div>
                              </div>
                              <div class="card">
                                   <div class="card-body">
                                        <div class="d-flex align-items-center justify-content-between">
                                             <h4 class="card-title flex-grow-1">
                                                  Sales Report
                                             </h4>

                                         <div class="dropdown">
                                              <a href="#" class="dropdown-toggle btn btn-sm btn-outline-light" data-bs-toggle="dropdown" aria-expanded="false">
                                                  Download
                                              </a>
                                              <div class="dropdown-menu dropdown-menu-end">
                                                   <!-- item-->
                                                   <button onclick="downloadPDF()" class="dropdown-item">PDF</button>
                                                   <!-- item-->
                                                   <button onclick="downloadExcel()" class="dropdown-item">EXCEL</button>
                                              </div>
                                         </div>
                                        </div>
                                   </div>
                                   <!-- single week and month sales report -->

                                   <div class="table-responsive table-centered" id="month-report-table">
                                    <table class="table mb-0">
                                         <thead id="report-thead" class="bg-light bg-opacity-50">
                                              <tr>
                                                   <th class="ps-3">
                                                    Date
                                                   </th>
                                                   <th>
                                                    Number of Orders
                                                   </th>
                                                   <th>
                                                    Products Sold
                                                   </th>
                                                   <th>
                                                    Total Sales
                                                   </th>
                                                   <th>
                                                    Discounts 
                                                   </th>
                                                   <th>
                                                    Net Sales
                                                   </th>
                                              </tr>
                                         </thead>
                                         <!-- end thead-->
                                         <tbody id="report-tBody">
                                          <% if(result) { %>
                                          <% for(let i = 0; i<result.length; i++) { %>
                                              <tr>
                                                   <td class="ps-3"><%= result[i].date %></td>
                                                   <td><%= result[i].numberOfOrders %></td>
                                                   <td><%= result[i].productsSold %></td>
                                                   <td><%= result[i].totalSales.toFixed(2) %></td>
                                                   <td><%= result[i].discounts.toFixed(2) %></td>
                                                   <td><%= result[i].netSales.toFixed(2) %></td>
                                              </tr>
                                              <% } %>
                                              <tr>
                                                 <td class="ps-3">Total</td>
                                                 <td><%= total.totalNoOfOrders %></td>
                                                 <td><%= total.totalProductSold %></td>
                                                 <td><%= total.allTotalSales.toFixed(2) %></td>
                                                 <td><%= total.totalDiscount.toFixed(2) %></td>
                                                 <td><%= total.totalNetSales.toFixed(2) %></td>
                                              </tr>
                                              <% } %>
                                         </tbody>
                                         <!-- end tbody -->
                                    </table>
                                    <!-- end table -->
                               </div>
                               <!-- table responsive -->
                              </div>
                              <!-- end card -->
                         </div>
                         <!-- end col -->
                    </div> <!-- end row -->

               </div>
               <!-- End Container Fluid -->

               <!-- ========== Footer Start ========== -->
               <footer class="footer">
                   <div class="container-fluid">
                       <div class="row">
                           <div class="col-12 text-center">
                               <script>document.write(new Date().getFullYear())</script> &copy; Larkon. Crafted by <iconify-icon icon="iconamoon:heart-duotone" class="fs-18 align-middle text-danger"></iconify-icon> <a
                                   href="https://1.envato.market/techzaa" class="fw-bold footer-text" target="_blank">Techzaa</a>
                           </div>
                       </div>
                   </div>
               </footer>
               <!-- ========== Footer End ========== -->

          </div>
          <!-- ==================================================== -->
          <!-- End Page Content -->
          <!-- ==================================================== -->

     </div>
     <!-- END Wrapper -->

     <!-- Vendor Javascript (Require in all Page) -->
     <script src="assets/js/vendor.js"></script>

     <!-- App Javascript (Require in all Page) -->
     <script src="assets/js/app.js"></script>

     <!-- Vector Map Js -->
     <script src="assets/vendor/jsvectormap/js/jsvectormap.min.js"></script>
     <script src="assets/vendor/jsvectormap/maps/world-merc.js"></script>
     <script src="assets/vendor/jsvectormap/maps/world.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/jspdf"></script>

     <!-- Dashboard Js -->
     <!-- <script src="assets/js/pages/dashboard.js"></script> -->
     <script>

      async function fetchData(event) {
        try {
          event.preventDefault();
          if(!validateDateRange()) {
            return;
          }
          const startDate = document.getElementById('startDate').value;
          const endDate = document.getElementById('endDate').value;
          const response = await fetch(`/admin/salesReport?srt_date=${startDate}&end_date=${endDate}`, {method: 'POST'});
          const data = await response.json();
          if(!response.ok) {
            throw new Error(data.message);
          } 
          if(data.success) {
            if(startDate === endDate) {
              createTableHeadRow('day');
              const existingTbody = document.getElementById('report-tBody');
              const newTbody = createDayTable(data.result, data.total);
              existingTbody.replaceWith(newTbody);
            } else {
              createTableHeadRow('month');
              const existingTbody = document.getElementById('report-tBody');
              const newTbody = createMonthTable(data.result, data.total);
              existingTbody.replaceWith(newTbody);
            }
          } 
        } catch (error) {
          Swal.fire({
               position: "top-end",
               icon: "error",
               title: "Oops...",
               text: error.message,
               showConfirmButton: false,
               timer: 1500,
               customClass: {
               popup: 'custom-swal-popup'
               }
          });
        }
      }

      document.getElementById('apply-btn').addEventListener('click', fetchData)

      function createMonthTable(result, total) {
        const tbody = document.createElement('tbody');
        tbody.id = 'report-tBody';
        result.forEach(item => {
          const row = document.createElement('tr');
          const cellDate = document.createElement('td');
          cellDate.classList.add('ps-3')
          cellDate.textContent = item.date;
          row.appendChild(cellDate);
          const cellNoOfOrd = document.createElement('td');
          cellNoOfOrd.textContent = item.numberOfOrders;
          row.appendChild(cellNoOfOrd);
          const cellProductSold = document.createElement('td');
          cellProductSold.textContent = item.productsSold;
          row.appendChild(cellProductSold);
          const cellTotalSale = document.createElement('td');
          cellTotalSale.textContent = item.totalSales.toFixed(2);
          row.appendChild(cellTotalSale);
          const cellDiscount = document.createElement('td');
          cellDiscount.textContent = item.discounts.toFixed(2);
          row.appendChild(cellDiscount);
          const cellNetSale = document.createElement('td');
          cellNetSale.textContent = item.netSales.toFixed(2);
          row.appendChild(cellNetSale);

          tbody.appendChild(row);
        });
        const rowOfTot = document.createElement('tr')
          const cellTotal = document.createElement('td');
          cellTotal.classList.add('ps-3')
          cellTotal.textContent = 'Total';
          rowOfTot.appendChild(cellTotal);
          const totNoOfOrd = document.createElement('td');
          totNoOfOrd.textContent = total.totalNoOfOrders;
          rowOfTot.appendChild(totNoOfOrd);
          const totProductSold = document.createElement('td');
          totProductSold.textContent = total.totalProductSold;
          rowOfTot.appendChild(totProductSold);
          const allTotalSale = document.createElement('td');
          allTotalSale.textContent = total.allTotalSales.toFixed(2);
          rowOfTot.appendChild(allTotalSale);
          const totDiscount = document.createElement('td');
          totDiscount.textContent = total.totalDiscount.toFixed(2);
          rowOfTot.appendChild(totDiscount);
          const totNetSale = document.createElement('td');
          totNetSale.textContent = total.totalNetSales.toFixed(2);
          rowOfTot.appendChild(totNetSale);

          tbody.appendChild(rowOfTot);

        return tbody;
      }


      function createDayTable(result, total) {
        const tbody = document.createElement('tbody');
        tbody.id = 'report-tBody';
        result.forEach(item => {
          const row = document.createElement('tr');
          const cellOrderid = document.createElement('td');
          cellOrderid.classList.add('ps-3')
          cellOrderid.textContent = item.orderId;
          row.appendChild(cellOrderid);
          const cellName = document.createElement('td');
          cellName.textContent = item.customerName;
          row.appendChild(cellName);
          const cellProductSold = document.createElement('td');
          cellProductSold.textContent = item.productsSold;
          row.appendChild(cellProductSold);
          const cellTotalSale = document.createElement('td');
          cellTotalSale.textContent = item.totalSales.toFixed(2);
          row.appendChild(cellTotalSale);
          const cellDiscount = document.createElement('td');
          cellDiscount.textContent = item.discount.toFixed(2);
          row.appendChild(cellDiscount);
          const cellNetSale = document.createElement('td');
          cellNetSale.textContent = item.netSales.toFixed(2);
          row.appendChild(cellNetSale);

          tbody.appendChild(row);
        });
        const rowOfTot = document.createElement('tr')
          const cellTotal = document.createElement('td');
          cellTotal.classList.add('ps-3')
          cellTotal.textContent = 'Total';
          rowOfTot.appendChild(cellTotal);
          const empty1 = document.createElement('td');
          empty1.textContent = '';
          rowOfTot.appendChild(empty1);
          const totProductSold = document.createElement('td');
          totProductSold.textContent = total.totalProductSold;
          rowOfTot.appendChild(totProductSold);
          const allTotalSale = document.createElement('td');
          allTotalSale.textContent = total.allTotalSales.toFixed(2);
          rowOfTot.appendChild(allTotalSale);
          const totDiscount = document.createElement('td');
          totDiscount.textContent = total.totalDiscount.toFixed(2);
          rowOfTot.appendChild(totDiscount);
          const totNetSale = document.createElement('td');
          totNetSale.textContent = total.totalNetSales.toFixed(2);
          rowOfTot.appendChild(totNetSale);

          tbody.appendChild(rowOfTot);

        return tbody;
      }


      function createTableHeadRow(data) {
            const monthHeaders = ['Date', 'Number of Orders', 'Products Sold', 'Total Sales', 'Discounts', 'Net Sales'];
            const dayHeaders = ['Order ID', 'Customer Name', 'Products Sold', 'Total Sales', 'Discounts', 'Net Sales'];

            // Select the thead
            const thead = document.getElementById('report-thead');
            thead.innerHTML = ''

            // Create the row
            const headerRow = document.createElement('tr');
            if(data === 'day') {
              dayHeaders.forEach(headerText => {
                const th = document.createElement('th');
                th.textContent = headerText;
                if (headerText === 'Order ID') th.className = 'ps-3'; // Add specific class for "Date"
                headerRow.appendChild(th);
              });
            } else {
            // Add each header as a <th>
              monthHeaders.forEach(headerText => {
                const th = document.createElement('th');
                th.textContent = headerText;
                if (headerText === 'Date') th.className = 'ps-3'; // Add specific class for "Date"
                headerRow.appendChild(th);
              });
            }
        

            // Append the row to the thead
            thead.appendChild(headerRow);
        }

      // Handle quick filter changes
      document.getElementById('quickFilter').addEventListener('change', function(e) {
          const today = new Date();
          const startDate = document.getElementById('startDate');
          const endDate = document.getElementById('endDate');
          
          switch(e.target.value) {
              case 'today':
                  startDate.value = formatDateInIST(today);
                  endDate.value = formatDateInIST(today);
                  break;
                  
              case 'week':
                  const weekAgo = new Date();
                  weekAgo.setDate(weekAgo.getDate() - 7);
                  startDate.value = formatDateInIST(weekAgo);
                  endDate.value = formatDateInIST(today);
                  break;
                  
              case 'month':
                  const monthAgo = new Date();
                  monthAgo.setDate(monthAgo.getDate() - 30);
                  startDate.value = formatDateInIST(monthAgo);
                  endDate.value = formatDateInIST(today);
                  break;
                  
              case 'all':
                  startDate.value = '2025-01-05';
                  endDate.value = formatDateInIST(today);
                  break;

              case 'year':
                  // const yearAgo = new Date();
                  // yearAgo.setDate(yearAgo.getDate() - 365); 
                  startDate.value = '2025-01-01';
                  endDate.value = formatDateInIST(today);
                  break;
          }
      });

      // Format date to YYYY-MM-DD
     function formatDateInIST(date) {
          const IST_OFFSET = 5.5 * 60 * 60 * 1000; // IST is UTC+5:30
          const istDate = new Date(date.getTime() + IST_OFFSET); // Adjust the date to IST

          const year = istDate.getUTCFullYear();
          const month = String(istDate.getUTCMonth() + 1).padStart(2, '0'); // Months are zero-based
          const day = String(istDate.getUTCDate()).padStart(2, '0');

          return `${year}-${month}-${day}`;
     }

     function allTimeDate() {
          const today = new Date();
          document.getElementById('startDate').value = '2025-01-05';
          document.getElementById('endDate').value = formatDateInIST(today);
     }
     allTimeDate();

      // Validate date range
      function validateDateRange() {
          const srtDate = document.getElementById('startDate').value;
          const endDate = document.getElementById('endDate').value;

          if(!srtDate || !endDate) {
            Swal.fire({
              position: "top-end",
              icon: "error",
              title: "Oops...",
              text: 'Start date and End date is required',
              showConfirmButton: false,
              timer: 1500,
              customClass: {
                  popup: 'custom-swal-popup'
              }
            });
            return false
          } 
          
          if (new Date(srtDate) > new Date(endDate)) {
              Swal.fire({
                position: "top-end",
                icon: "error",
                title: "Oops...",
                text: 'Start date cannot be later than end date',
                showConfirmButton: false,
                timer: 1500,
                customClass: {
                    popup: 'custom-swal-popup'
                }
              });
              return false;
          }
          return true;
      }

     async function downloadPDF() { 
          try {
               const startDate = document.getElementById('startDate').value;
               const endDate = document.getElementById('endDate').value;
               const response = await fetch(`/admin/download/pdf?startDate=${startDate}&endDate=${endDate}`)
               if(!response.ok) {
                    const data = await response.json();
                    throw new Error(data.message);
               }
               const blob = await response.blob();
            
               const url = window.URL.createObjectURL(blob);

               const a = document.createElement('a');
               a.href = url;
               a.download = `Sales report (${startDate} to ${endDate}).pdf`; // Set the download file name
               document.body.appendChild(a);
               a.click();

               // Clean up
               a.remove();
               window.URL.revokeObjectURL(url);
          } catch (error) {
               Swal.fire({
                    position: "top-end",
                    icon: "error",
                    title: "Oops...",
                    text: error.message,
                    showConfirmButton: false,
                    timer: 1500,
                    customClass: {
                         popup: 'custom-swal-popup'
                    }
               });
          }
       
     }
     async function downloadExcel() { 
          try {
               const startDate = document.getElementById('startDate').value;
               const endDate = document.getElementById('endDate').value;
               const response = await fetch(`/admin/download/excel?startDate=${startDate}&endDate=${endDate}`)
               if(!response.ok) {
                    const data = await response.json();
                    throw new Error(data.message);
               }
               const blob = await response.blob();
            
               const url = window.URL.createObjectURL(blob);

               const a = document.createElement('a');
               a.href = url;
               a.download = `Sales report (${startDate} to ${endDate}).xlsx`; 
               document.body.appendChild(a);
               a.click();

               // Clean up
               a.remove();
               window.URL.revokeObjectURL(url);
          } catch (error) {
               Swal.fire({
                    position: "top-end",
                    icon: "error",
                    title: "Oops...",
                    text: error.message,
                    showConfirmButton: false,
                    timer: 1500,
                    customClass: {
                         popup: 'custom-swal-popup'
                    }
               });
          }
       
     }
     async function logout() {
          try {
               const response = await fetch('/admin/logout', {method: 'POST'})
               const data = await response.json();
               if(!response.ok) {
                    throw new Error(data.message);
               }
               if(data.success) {
                    window.location.href = '/admin/login'
               }
          } catch (error) {
               Swal.fire({
                    position: "top-end",
                    icon: "error",
                    title: "Oops...",
                    text: error.message,
                    showConfirmButton: false,
                    timer: 1500,
                    customClass: {
                         popup: 'custom-swal-popup'
                    }
               });
          }
     }

     document.getElementById('logout-btn').addEventListener('click', logout);

  </script>

</body>


<!-- Mirrored from techzaa.in/larkon/admin/index.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 03 Dec 2024 05:42:46 GMT -->
</html>