<!DOCTYPE html>
<html lang="en">


<!-- Mirrored from techzaa.in/larkon/admin/product-list.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 03 Dec 2024 05:43:10 GMT -->
<head>
     <!-- Title Meta -->
     <meta charset="utf-8" />
     <title>Product List | Larkon - Responsive Admin Dashboard Template</title>
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <meta name="description" content="A fully responsive premium admin dashboard template" />
     <meta name="author" content="Techzaa" />
     <meta http-equiv="X-UA-Compatible" content="IE=edge" />

     <!-- App favicon -->
     <link rel="shortcut icon" href="assets/images/favicon.ico">

     <!-- Vendor css (Require in all Page) -->
     <link href="assets/css/vendor.min.css" rel="stylesheet" type="text/css" />

     <!-- Icons css (Require in all Page) -->
     <link href="assets/css/icons.min.css" rel="stylesheet" type="text/css" />

     <!-- App css (Require in all Page) -->
     <link href="assets/css/app.min.css" rel="stylesheet" type="text/css" />

     <!-- Theme Config js (Require in all Page) -->
     <script src="assets/js/config.js"></script>
     <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

     <style>
     .short-swal-popup {
          width: 300px; 
          padding: 0;
          font-size: 15px;
     }

     .short-swal-content {
          font-size: 15px;
          margin: 0; 
          padding: 0; 
     }

     .short-swal-confirm-btn {
          padding: 5px 10px;
          font-size: 15px;
          border-radius: 4px;
     }

     .short-swal-cancel-btn {
          padding: 5px 10px;
          font-size: 15px;
          border-radius: 4px;
     }

     
     .swal2-actions {
          gap: 5px; 
     }

     .swal2-icon.swal2-error {
          display: flex;
          align-items: center;
          justify-content: center;
          width: 30px; 
          height: 30px;
          margin: 0; 
          font-size: 15px;
          line-height: 30px; 
     }

     .swal2-icon.swal2-error::before {
          content: 'âœ–'; 
          color: red;
     }

     .compact-swal-popup {
          width: auto !important; 
          height: auto !important; 
          padding: 20px 20px !important;
          display: flex;
          align-items: center;
          justify-content: center;
          border-radius: 8px;
     }
     .swal2-title {
          font-size: 18px !important;
          margin: 0 !important;
          line-height: 1.5 !important;
     }


     .swal2-html-container {
          margin: 0 !important; 
     }

     .swal2-timer-progress-bar {
      height: 2px !important;
     }
     </style>
</head>

<body>

     <!-- START Wrapper -->
     <div class="wrapper">

          <!-- ========== Topbar Start ========== -->
          <%- include('../partials/admin/header') %>
          <!-- Right Sidebar (Theme Settings) -->
          <%- include('../partials/admin/theme') %>
          <!-- ========== Topbar End ========== -->

          <!-- ========== App Menu Start ========== -->
          <%- include('../partials/admin/nav') %>
          <!-- ========== App Menu End ========== -->

          <!-- ==================================================== -->
          <!-- Start right Content here -->
          <!-- ==================================================== -->
          <div class="page-content">

               <!-- Start Container Fluid -->
               <div class="container-fluid">

                    <div class="row">
                         <div class="col-xl-12">
                              <div class="card">
                                   <div class="card-header d-flex justify-content-between align-items-center gap-1">
                                        <h4 class="card-title flex-grow-1">All Product List</h4>

                                        <a href="/admin/addProducts" class="btn btn-sm btn-primary">
                                             Add Product
                                        </a>
                                   </div>
                                   <div>
                                        <div class="table-responsive">
                                             <table class="table align-middle mb-0 table-hover table-centered">
                                                  <thead class="bg-light-subtle">
                                                       <tr>
                                                            <th style="width: 20px;"></th>
                                                            <th>Product Name</th>
                                                            <th>Variants</th>
                                                            <th>Price</th>
                                                            <th>Category</th>
                                                            <th>Action</th>
                                                       </tr>
                                                  </thead>
                                                  <tbody>
                                                       <% for(let i = 0; i < data.length; i++) { %>
                                                       <tr>
                                                            <td>
                                                                 <%= ((currentPage - 1) * 10) + i + 1 %>
                                                            </td>
                                                            <td>
                                                                 <div class="d-flex align-items-center gap-2">
                                                                      <div class="rounded bg-light avatar-md d-flex 1align-items-center justify-content-center">
                                                                           <img src="<%= data[i].variant[0].image[0] %>" alt="" class="avatar-md">
                                                                      </div>
                                                                      <div>
                                                                           <p class="text-dark fw-medium fs-15"><%= data[i].productName %></p>
                                                                      </div>
                                                                 </div>

                                                            </td>
                                                            <td><%= data[i].variant.length %></td>
                                                            <td><%= data[i].salePrice %></td>
                                                            <td> <%= data[i].category.name %></td>
                                                            <td>
                                                                 <div class="d-flex gap-2">
                                                                      <a href="/admin/productDetails?id=<%= data[i]._id %>" class="btn btn-light btn-sm"><iconify-icon icon="solar:eye-broken" class="align-middle fs-18"></iconify-icon></a>
                                                                      <% if(data[i].isBlocked === false) { %>
                                                                      <button class="btn btn-danger" id="block-btn<%= i %>" onclick="blockProduct(event, '<%= data[i]._id %>', '<%= i %>')">Block</button>
                                                                      <button class="btn btn-success d-none" id="unblock-btn<%= i %>" onclick="unblockProduct(event, '<%= data[i]._id %>', '<%= i %>')">Unblock</button>
                                                                      <% } else { %>
                                                                      <button class="btn btn-danger d-none" id="block-btn<%= i %>" onclick="blockProduct(event, '<%= data[i]._id %>', '<%= i %>')">Block</button>
                                                                      <button class="btn btn-success" id="unblock-btn<%= i %>" onclick="unblockProduct(event, '<%= data[i]._id %>', '<%= i %>')">Unblock</button>
                                                                      <% } %>
                                                                      <a href="/admin/editProduct?id=<%= data[i]._id %>" class="btn btn-info text-white">Edit</a>
                                                                 </div>
                                                            </td>
                                                       </tr>
                                                       <% } %>
                                                  </tbody>
                                             </table>
                                        </div>
                                        <!-- end table-responsive -->
                                   </div>
                                   <div class="card-footer border-top">
                                        <nav aria-label="Page navigation example">
                                             <ul class="pagination justify-content-end mb-0">
                                                  <% if(currentPage > 1) { %>
                                                       <li class="page-item"><a class="page-link" href="?page=<%= currentPage - 1 %>">Previous</a></li>
                                                  <% } for(let i = 1; i<= totalPages; i++) { if(i == currentPage) { %>
                                                       <li class="page-item active"><a class="page-link"><%= i %></a></li>
                                                  <% } else { %>
                                                       <li class="page-item"><a class="page-link" href="?page=<%= i %>"><%= i %></a></li>
                                                  <% }} if(currentPage < totalPages) { %>
                                                       <li class="page-item"><a class="page-link" href="?page=<%= Number(currentPage) + 1 %>">Next</a></li>
                                                  <% } %> 
                                         
                                             </ul>
                                        </nav>
                                   </div>
                              </div>
                         </div>

                    </div>

               </div>
               <!-- End Container Fluid -->

               <!-- ========== Footer Start ========== -->
               <%- include('../partials/admin/footer') %>
               <!-- ========== Footer End ========== -->

          </div>
          <!-- ==================================================== -->
          <!-- End Page Content -->
          <!-- ==================================================== -->

     </div>
     <!-- END Wrapper -->

     <!-- Vendor Javascript (Require in all Page) -->
     <script src="assets/js/vendor.js"></script>

     <!-- App Javascript (Require in all Page) -->
     <script src="assets/js/app.js"></script>
     <script>
          async function blockProduct(event, id, i) {
               event.preventDefault();
               try {
                    const result = await Swal.fire({
                         position: "top-end",
                         title: 'Are you sure you want to block?',
                         showCancelButton: true,
                         confirmButtonColor: '#3085d6',
                         cancelButtonColor: '#d33',
                         confirmButtonText: 'Yes',
                         cancelButtonText: 'No',
                         customClass: {
                              popup: 'short-swal-popup',
                              confirmButton: 'short-swal-confirm-btn',
                              cancelButton: 'short-swal-cancel-btn'
                         }
                    })
                    if(result.isConfirmed) {
                         const response = await fetch(`/admin/blockProduct?id=${id}`, {method: 'PATCH'});
                         const data = await response.json(); 
                         if(!response.ok) {
                              throw new Error(data.message);
                         }
                         if(data.success) {
                              document.getElementById('block-btn'+i).classList.add('d-none');
                              document.getElementById('unblock-btn'+i).classList.remove('d-none');
                         } 
                    } 
                
               } catch (error) {
                    Swal.fire({
                         position: "top-end",
                         html: `
                              <div style="display: flex; align-items: center; gap: 10px;">
                                   <div>
                                        <div class="swal2-icon swal2-error" style="width: 30px; height: 30px; margin: 0; font-size: 16px;"></div>
                                   </div>
                                   <div style="font-size: 20px; text-align: left;">Oops... ${error.message}</div>
                              </div>
                         `,
                         showConfirmButton: false,
                         timer: 1500,
                         customClass: {
                              popup: 'compact-swal-popup',
                         }
                    });
               }
              
          }
          async function unblockProduct(event, id, i) {
               event.preventDefault();
               try {
                    const result = await Swal.fire({
                         position: "top-end",
                         title: 'Are you sure you want to unblock?',
                         showCancelButton: true,
                         confirmButtonColor: '#3085d6',
                         cancelButtonColor: '#d33',
                         confirmButtonText: 'Yes',
                         cancelButtonText: 'No',
                         customClass: {
                              popup: 'short-swal-popup',
                              confirmButton: 'short-swal-confirm-btn',
                              cancelButton: 'short-swal-cancel-btn'
                         }
                    })
                    if(result.isConfirmed) {
                         const response = await fetch(`/admin/unblockProduct?id=${id}`, {method: 'PATCH'})
                         const data = await response.json();
                         if(!response.ok) {
                              throw new Error(data.message);
                         }
                         if(data.success) {
                              document.getElementById('unblock-btn'+i).classList.add('d-none');
                              document.getElementById('block-btn'+i).classList.remove('d-none');
                         }         
                    } 
               } catch (error) {
                    Swal.fire({
                         position: "top-end",
                         html: `
                              <div style="display: flex; align-items: center; gap: 10px;">
                                   <div>
                                        <div class="swal2-icon swal2-error" style="width: 30px; height: 30px; margin: 0; font-size: 16px;"></div>
                                   </div>
                                   <div style="font-size: 20px; text-align: left;">Oops... ${error.message}</div>
                              </div>
                         `,
                         showConfirmButton: false,
                         timer: 1500,
                         customClass: {
                              popup: 'compact-swal-popup',
                         }
                    });
               }
          }

     async function logout() {
          try {
               const response = await fetch('/admin/logout', {method: 'POST'})
               const data = await response.json();
               if(!response.ok) {
                    throw new Error(data.message);
               }
               if(data.success) {
                    window.location.href = '/admin/login'
               }
          } catch (error) {
               Swal.fire({
                    position: "top-end",
                    icon: "error",
                    title: "Oops...",
                    text: error.message,
                    showConfirmButton: false,
                    timer: 1500,
                    customClass: {
                         popup: 'custom-swal-popup'
                    }
               });
          }
     }

     document.getElementById('logout-btn').addEventListener('click', logout);

     </script>
</body>


<!-- Mirrored from techzaa.in/larkon/admin/product-list.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 03 Dec 2024 05:43:15 GMT -->
</html>